---
title: "Challenge 4"
subtitle: "Customising figures"
output: html_document
---

**Learning objectives** 

* Figure sizes
* Figure captions
* Inserting images 

```{r, message = FALSE}
library(tidyverse)

knitr::opts_chunk$set(
  fig.path   ='figure/',
  fig.align  ='center',
  fig.retina = 2
)
```


There is a data set called `cars` that is loaded into R. You can have a look at the data set by typing `cars` into R.

```{r}
cars
```

I can get a scatter plot of the `speed` vs `dist` using `ggplot2` (which was loaded with `tidyverse`):

```{r}
ggplot(cars, aes(dist, speed)) + 
  geom_point()
```

## Figure sizes

By default the figure width is 7 inches and figure width is 5 inches for `html_document` output. You can change this to say 1 inch by setting the chunk options `fig.height = 1, fig.width = 1`. The values for `fig.height` and `fig.width` are required to be both numeric (measured in inches).

```{r, fig.height = 1, fig.width = 1}
ggplot(cars, aes(dist, speed)) + 
  geom_point()
```

Another way to scale your image is using `out.width` and `out.height`. These two options can only take character as values and this may depend on the output format. E.g. you can use `".8\\linewidth"`for pdf output (`\linewidth` is a LaTeX command) or `"300px"` for html output. You may also use percentage which scales appropriately for both html and pdf outputs. Below figure we use `out.width = "60%", out.height = "60%"`.

```{r, out.width = "60%", out.height = "60%"}
ggplot(cars, aes(dist, speed)) + 
  geom_point()
```

We can use `fig.width` and `fig.height` with `out.width` and `out.height`. Below we have `fig.width = 3, fig.height = 3, out.width = "60%", out.height = "60%"`.

```{r, fig.width = 3, fig.height = 3, out.width = "60%", out.height = "60%"}
ggplot(cars, aes(dist, speed)) + 
  geom_point()
```

Getting the figure to "look" right usually requires playing around with these options.

`r emo::ji("question")` **What happens if your code chunk generates multiple figures?**

## Figure alignment

You may have noticed but in the global chunk I have set `fig.align = "center"` so that the figures will be centered as default. 

The other valid values are `default` (no alignment), `left` and `right`.  Below figure has `fig.align = "left"`.

```{r, fig.width = 3, fig.height = 3, out.width = "60%", out.height = "60%", fig.align = "left"}
ggplot(cars, aes(dist, speed)) + 
  geom_point()
```

`r emo::ji("wrench")` **Try changing the above figure so that the alignment is on the right instead.**

## Figure caption

You can include a figure caption by using the chunk option `fig.cap`.

```{r, fig.cap = "This is a boring scatter plot"}
ggplot(cars, aes(dist, speed)) + 
  geom_point()
```

Chunk options must be written in one line. This means that you cannot add a line break. This can make the line awkwardly long when you need to write a long caption. 

Remember that chunk option values accept valid R expressions. As one work around, you can define a string variable, say `cap`, that contains the long caption as an inline R command. Then you can set option as `fig.cap = cap`. This is how the below caption was generated. Study the Rmd source code for how the caption was generated.


`r cap <- "This is some really long text that may be hard to fit within the chunk option."`


```{r, fig.cap = cap}
ggplot(cars, aes(dist, speed)) + 
  geom_point()
```

If using `bookdown` output formats then there is another way to deal with these long captions [as described in the bookdown book](https://bookdown.org/yihui/bookdown/markdown-extensions-by-bookdown.html#text-references). We'll come back to this later.

## Exporting the figures

If you want to save the figures that you created from your code, these can be saved by setting `fig.path`. Globally we have set `fig.path = "figures/"` so you can find all figures generated in the folder `figures` already.

`r emo::ji("question")` **Do you notice something about the figure names in the `figure` folder?** Don't fret if you don't. We'll come back to this point later. 

## Inserting images 

To insert images in markdown, you can use `![](/path/to/your/image)`. The following logo is inserted using markdown syntax:

![](images/rlogo.svg)

However to apply captions and images resizing as before, you want to insert the image via a chunk using `knitr::include_graphics()` as below.

```{r logo, out.width = "40%", fig.cap = "The logo of statistical software R"}
knitr::include_graphics("images/rlogo.svg")
```

Plot & image customisation takes a number of tries to get it to look right. The huge advantage of R Markdown is that if you want to change the look of an image generated by code, this is easy - only requires some parameter change and knit again. 

In the past, I had to 

1. go to the script (which was separate to the document) that generated the figures; 
1. change the parameter there; 
1. generate the figures; 
1. go back to document; and 
1. compile the document. 

Now I

1. go to my document;
1. change parameter setting; and
1. compile the document.

While it seems a small thing, there's **_friction in my workflow_**. It's worth investing to make your workflow smoother even if it takes time to learn initially. In the long term, you have more time on more important matters.

`r emo::ji("question")` **What tasks do you repea often or hinder productiveness in your work? Can you think of how to make your workflow smoother?**

